<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|console:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"s0uthwood.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="NepCTF2021 reverse 前四题">
<meta property="og:type" content="article">
<meta property="og:title" content="NepCTF2021 re writeups">
<meta property="og:url" content="https://s0uthwood.github.io/2021/03/22/NepCTF2021-re-writeups/index.html">
<meta property="og:site_name" content="s0uthwood&#39;s Blog">
<meta property="og:description" content="NepCTF2021 reverse 前四题">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-22T10:30:03.000Z">
<meta property="article:modified_time" content="2021-05-19T17:43:17.026Z">
<meta property="article:author" content="s0uthwood">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://s0uthwood.github.io/2021/03/22/NepCTF2021-re-writeups/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>NepCTF2021 re writeups | s0uthwood's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="s0uthwood's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">s0uthwood's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://s0uthwood.github.io/2021/03/22/NepCTF2021-re-writeups/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar3.jpg">
      <meta itemprop="name" content="s0uthwood">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="s0uthwood's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          NepCTF2021 re writeups
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-22 18:30:03" itemprop="dateCreated datePublished" datetime="2021-03-22T18:30:03+08:00">2021-03-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-20 01:43:17" itemprop="dateModified" datetime="2021-05-20T01:43:17+08:00">2021-05-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>17k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>16 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>NepCTF2021 reverse 前四题</p>
<a id="more"></a>
<h1 id="hardsharp-NET-逆向"><a href="#hardsharp-NET-逆向" class="headerlink" title="hardsharp (.NET 逆向)"></a>hardsharp (.NET 逆向)</h1><p>使用exeinfo发现是 C# .NET文件</p>
<p>直接用 dnSpy 打开</p>
<p>找到主函数</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AesClass aesClass = <span class="keyword">new</span> AesClass();</span><br><span class="line">	<span class="built_in">string</span> text = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="built_in">string</span> strB = <span class="string">&quot;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH/3Wh0&quot;</span>;</span><br><span class="line">	<span class="built_in">byte</span>[] array = <span class="keyword">new</span> <span class="built_in">byte</span>[]</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">81</span>,</span><br><span class="line">		<span class="number">82</span>,</span><br><span class="line">		<span class="number">87</span>,</span><br><span class="line">		<span class="number">81</span>,</span><br><span class="line">		<span class="number">82</span>,</span><br><span class="line">		<span class="number">87</span>,</span><br><span class="line">		<span class="number">68</span>,</span><br><span class="line">		<span class="number">92</span>,</span><br><span class="line">		<span class="number">94</span>,</span><br><span class="line">		<span class="number">86</span>,</span><br><span class="line">		<span class="number">93</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">18</span></span><br><span class="line">	&#125;;</span><br><span class="line">	Console.WriteLine(<span class="string">&quot;Welcome to nepnep csharp test! plz input the magical code:&quot;</span>);</span><br><span class="line">	<span class="built_in">string</span> text2 = Console.ReadLine();</span><br><span class="line">	<span class="keyword">if</span> (text2.Length != <span class="number">37</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(<span class="string">&quot;Nope!&quot;</span>);</span><br><span class="line">		Console.ReadKey();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (text2.Substring(<span class="number">0</span>, <span class="number">4</span>) != <span class="string">&quot;Nep&#123;&quot;</span> || text2[<span class="number">36</span>] != <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(<span class="string">&quot;Nope!&quot;</span>);</span><br><span class="line">		Console.ReadKey();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		text += Convert.ToChar((<span class="built_in">int</span>)(array[i] ^ <span class="number">51</span>)).ToString();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">string</span>.Compare(aesClass.AesEncrypt(text2, text), strB) == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(<span class="string">&quot;wow, you pass it!&quot;</span>);</span><br><span class="line">		Console.ReadKey();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Console.WriteLine(<span class="string">&quot;Nope!&quot;</span>);</span><br><span class="line">	Console.ReadKey();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这才是真正的签到题吧…</p>
<p>发现是 AES 加密</p>
<p>进入 AesEncrypt 函数看一眼</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">AesEncrypt</span>(<span class="params"><span class="built_in">string</span> str, <span class="built_in">string</span> key</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(str))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">byte</span>[] bytes = Encoding.UTF8.GetBytes(str);</span><br><span class="line">	<span class="built_in">byte</span>[] array = <span class="keyword">new</span> RijndaelManaged</span><br><span class="line">	&#123;</span><br><span class="line">		Key = Encoding.UTF8.GetBytes(key),</span><br><span class="line">		Mode = CipherMode.ECB,</span><br><span class="line">		Padding = PaddingMode.PKCS7</span><br><span class="line">	&#125;.CreateEncryptor().TransformFinalBlock(bytes, <span class="number">0</span>, bytes.Length);</span><br><span class="line">	<span class="keyword">return</span> Convert.ToBase64String(array, <span class="number">0</span>, array.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现使用了 ECB 模式，那么直接上网找个 python 脚本计算就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">array = [<span class="number">81</span>, <span class="number">82</span>, <span class="number">87</span>, <span class="number">81</span>, <span class="number">82</span>, <span class="number">87</span>, <span class="number">68</span>, <span class="number">92</span>, <span class="number">94</span>, <span class="number">86</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>]</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">    key += <span class="built_in">chr</span>(i ^ <span class="number">51</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">f&#x27;key: <span class="subst">&#123;key&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">f&#x27;key length: <span class="subst">&#123;<span class="built_in">len</span>(key)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">message = <span class="string">&#x27;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH/3Wh0&#x27;</span></span><br><span class="line">encrypt_data = message</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key)</span><br><span class="line">result2 = base64.b64decode(encrypt_data)</span><br><span class="line">a = cipher.decrypt(result2)</span><br><span class="line"></span><br><span class="line">a = a.decode(<span class="string">&#x27;utf-8&#x27;</span>,<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">a = a.rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">a = a.rstrip(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">a = a.rstrip(<span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">a = a.replace(<span class="string">&#x27;\x06&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;data:&#x27;</span>,a)</span><br></pre></td></tr></table></figure>
<p>得到结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key: badbadwomen!!!!!!!!!!!!!!!!!!!!!</span><br><span class="line">key length: 32</span><br><span class="line"></span><br><span class="line"> data: Nep&#123;up_up_down_down_B_a_b_A_Nep_nep~&#125;</span><br></pre></td></tr></table></figure>
<h1 id="二十六进制-（c-c-逆向）"><a href="#二十六进制-（c-c-逆向）" class="headerlink" title="二十六进制 （c / c++ 逆向）"></a>二十六进制 （c / c++ 逆向）</h1><p>先用exeinfo打开，发现是无壳32位c++代码。</p>
<p>用ida打开，找到有用的字符串，定位关键代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __noreturn <span class="title">sub_4010A0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> Dst; <span class="comment">// [esp+0h] [ebp-108h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;Dst, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  dword_403378 = (<span class="keyword">int</span>)<span class="built_in">malloc</span>(<span class="number">8u</span>);</span><br><span class="line">  Memory = (<span class="keyword">void</span> *)dword_403378;</span><br><span class="line">  *(_DWORD *)(dword_403378 + <span class="number">4</span>) = <span class="number">0</span>;</span><br><span class="line">  sub_401020(<span class="string">&quot;plz input right num:\n&quot;</span>, Dst);</span><br><span class="line">  sub_401060(<span class="string">&quot;%s&quot;</span>, &amp;Dst, <span class="number">32</span>);</span><br><span class="line">  v0 = atoi64(&amp;Dst);</span><br><span class="line">  sub_401120(v0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输入一个数字，将其传入 <code>sub_401120</code> 函数。</p>
<p>进入这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl __noreturn <span class="title">sub_401120</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 v1; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// cl</span></span><br><span class="line"></span><br><span class="line">  v1 = __PAIR__(a1, HIDWORD(a1));</span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = sub_401F00(__PAIR__(v1, HIDWORD(v1)), <span class="number">0x1A</span>u, <span class="number">0</span>);</span><br><span class="line">      LODWORD(v1) = v3;</span><br><span class="line">      v4 = byte_402194[HIDWORD(v1) - <span class="number">26</span> * v2];  <span class="comment">// 2163qwe)(*&amp;^%489$!057@#&gt;&lt;A</span></span><br><span class="line">      HIDWORD(v1) = v2;</span><br><span class="line">      sub_401160(v4 ^ <span class="number">7</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v1 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401190();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据题目信息的提示，这是把输入数字转换成为26进制，随后进行一个异或运算，然后存到一个地址里。</p>
<p>进入 <code>sub_401190</code> 函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __noreturn <span class="title">sub_401190</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v0; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// ecx</span></span><br><span class="line">  _DWORD *v2; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">void</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+10h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v0 = Memory;</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v2 = Memory;</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(aFb726);</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !v2 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v5 = &amp;aFb726[v4];</span><br><span class="line">      v6 = *(_BYTE *)v2;</span><br><span class="line">      v7 = v10 + <span class="number">1</span>;</span><br><span class="line">      v2 = (_DWORD *)v2[<span class="number">1</span>];</span><br><span class="line">      ++v4;</span><br><span class="line">      <span class="keyword">if</span> ( v6 != *v5 )</span><br><span class="line">        v7 = v10;</span><br><span class="line">      v1 = v7;</span><br><span class="line">      v10 = v7; <span class="comment">// 判断某内存种对应位置是否与 aFb726 字符串相同，相同就在长度上加 1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 &lt; v3 );</span><br><span class="line">    v0 = Memory;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v0 ) </span><br><span class="line">  &#123;</span><br><span class="line">    v8 = v1;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (<span class="keyword">void</span> *)v0[<span class="number">1</span>];</span><br><span class="line">      dword_403378 = (<span class="keyword">int</span>)v0;</span><br><span class="line">      Memory = v9;</span><br><span class="line">      <span class="built_in">free</span>(v0);</span><br><span class="line">      v0 = Memory;</span><br><span class="line">      --v8;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( Memory ); <span class="comment">// 释放内存</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 != <span class="built_in">strlen</span>(aFb726) ) <span class="comment">// 根据之间计算的相同字母数量，判断两个字符串是否相同</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;flag is Error!!!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;flag is Right!!!, please md5(&#x27;Nep&#123;you_input_num&#125;&#x27;) submit th4 flag&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(v8);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以只需要将 aFb726 字符串进行反向计算即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = <span class="string">&#x27;Fb72&gt;&amp;6&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">str</span> = <span class="string">&#x27;2163qwe)(*&amp;^%489$!057@#&gt;&lt;A&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num = []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> c <span class="keyword">in</span> flag:</span><br><span class="line"><span class="meta">... </span>    num.append(<span class="built_in">str</span>.index(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ <span class="number">7</span>)))</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num</span><br><span class="line">[<span class="number">25</span>, <span class="number">6</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> num[::<span class="number">-1</span>]:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">sum</span> *= <span class="number">26</span></span><br><span class="line"><span class="meta">... </span>    <span class="built_in">sum</span> += i</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sum</span></span><br><span class="line"><span class="number">518100101</span></span><br></pre></td></tr></table></figure>
<p>运行程序进行测试，得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plz input right num:</span><br><span class="line">518100101</span><br><span class="line">flag is Right!!!, please md5(&#39;Nep&#123;you_input_num&#125;&#39;) submit th4 flag</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>
<p>根据题目信息，计算一下数字的32位小写md5（一开始算的是 Nep{51…01} 这个字符串的md5，发现不对，所以算数字的试了一下）</p>
<p>得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;967fa25cbea166ded43127f141cff31a&#125;</span><br></pre></td></tr></table></figure>
<h1 id="password-（安卓逆向）"><a href="#password-（安卓逆向）" class="headerlink" title="password （安卓逆向）"></a>password （安卓逆向）</h1><p>这道题做了好久都没做出来，结果发现是把base64的 ‘+/‘ 记反了…</p>
<hr>
<p>首先用 <code>jeb</code> 打开，找到 <code>com.nepnep.app</code> 中的 <code>MainActivity</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Encrypt en;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainActivity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.en = <span class="keyword">new</span> Encrypt();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle arg4)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(arg4);</span><br><span class="line">        <span class="keyword">this</span>.setContentView(<span class="number">0x7F0B001C</span>);  <span class="comment">// activity_main</span></span><br><span class="line">        <span class="keyword">this</span>.findViewById(<span class="number">0x7F080057</span>).setOnClickListener(<span class="keyword">new</span> View$OnClickListener(<span class="keyword">this</span>.findViewById(<span class="number">0x7F0800B7</span>), <span class="keyword">this</span>.findViewById(<span class="number">0x7F0800F2</span>)) &#123;  <span class="comment">// btn, key, password</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View arg4)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(MainActivity.<span class="keyword">this</span>.verify(<span class="keyword">this</span>.val$key.getText().toString()) == <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(<span class="keyword">this</span>.val$key.getText().toString());</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;key错误！&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(MainActivity.<span class="keyword">this</span>.en.file(<span class="keyword">this</span>.val$passwd.getText().toString().getBytes(), <span class="keyword">this</span>.val$key.getText().toString())) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;明文正确，快去解压缩包获取flag吧！&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;明文错误！&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">verify</span><span class="params">(String arg1)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码是读入 <code>key</code> 和 <code>password</code>，然后先判断 <code>key</code> 是否正确，如果正确的话判断 <code>password</code> 是否正确</p>
<p>那么肯定先破解 <code>key</code>，发现 <code>verify</code> 是外部函数</p>
<p>找到 <code>native-lib.so</code> 文件，拖入ida，找到函数名里搜索 <code>java</code> 或 <code>verify</code> 之类的，找到这个判断函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">  v4 = (<span class="keyword">char</span> *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="number">1352L</span>L))(a1, a3, <span class="number">0L</span>L);</span><br><span class="line">  v5 = (*(__int64 (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + <span class="number">1344L</span>L))(a1, v3);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x3E8</span>uLL);</span><br><span class="line">  sub_710(v4, (__int64)&amp;s, v5 - 3 * (((unsigned __int64)(&#x27;UUUV&#x27; * v5) &gt;&gt; 63) + ((unsigned __int64)(&#x27;UUUV&#x27; * v5) &gt;&gt; 32)));</span><br><span class="line">  sub_820(&amp;s, (__int64)&amp;v22);                   <span class="comment">// s=&#x27;th1s_1s_k3ya!!!!&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )                                   <span class="comment">// base64</span></span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v6;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &gt;= <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6)];<span class="comment">// abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></span><br><span class="line">      *((_BYTE *)&amp;v15 + v6 + <span class="number">1</span>) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">1</span>)];</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6 + <span class="number">2</span>) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">2</span>)];</span><br><span class="line">      v7 = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">3</span>)];</span><br><span class="line">      v6 += <span class="number">4</span>;</span><br><span class="line">      *((_BYTE *)&amp;v15 + v11 + <span class="number">3</span>) = v7;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6)];</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6 + <span class="number">1</span>) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">1</span>)];</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6 + <span class="number">2</span>) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">2</span>)];</span><br><span class="line">      *((_BYTE *)&amp;v15 + v6 + <span class="number">3</span>) = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_4:</span><br><span class="line">    v10 = __OFADD__(<span class="number">-3</span>, v5);</span><br><span class="line">    v8 = v5 == <span class="number">3</span>;</span><br><span class="line">    v9 = v5 - <span class="number">3</span> &lt; <span class="number">0</span>;</span><br><span class="line">    v5 -= <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)(v9 ^ v10) | v8 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  &#125;</span><br><span class="line">  *((_BYTE *)&amp;v15 + v6) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6)];</span><br><span class="line">  *((_BYTE *)&amp;v15 + v6 + <span class="number">1</span>) = aAbcdefghijklmn[*((<span class="keyword">char</span> *)&amp;v22 + v6 + <span class="number">1</span>)];</span><br><span class="line">  *(_WORD *)((char *)&amp;v15 + v6 + 2) = &#x27;==&#x27;;</span><br><span class="line">LABEL_10:</span><br><span class="line">  (*(<span class="keyword">void</span> (__fastcall **)(__int64, __int64, <span class="keyword">char</span> *))(*(_QWORD *)a1 + <span class="number">1360L</span>L))(a1, v3, v4);</span><br><span class="line">  v12 = _mm_movemask_epi8(</span><br><span class="line">          _mm_and_si128(</span><br><span class="line">            _mm_cmpeq_epi8(_mm_load_si128((<span class="keyword">const</span> __m128i *)&amp;v15), (__m128i)xmmword_BE0),</span><br><span class="line">            _mm_cmpeq_epi8(_mm_loadu_si128((<span class="keyword">const</span> __m128i *)((<span class="keyword">char</span> *)&amp;v15 + <span class="number">9</span>)), (__m128i)xmmword_BD0)));<span class="comment">// 3g6L2PWL2PXFmR+7ise7iq==</span></span><br><span class="line">  __android_log_print(<span class="number">4L</span>L, <span class="string">&quot;nepnep&quot;</span>, <span class="string">&quot;%s&quot;</span>, &amp;v15);</span><br><span class="line">  result = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( v12 == <span class="number">0xFFFF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    __android_log_print(<span class="number">4L</span>L, <span class="string">&quot;nepnep&quot;</span>, <span class="string">&quot;key is true!&quot;</span>, v13);</span><br><span class="line">    result = <span class="number">1L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>
<p>我们的目的肯定是让 <code>v12 = 0FFFF</code></p>
<p>虽然对于 mm 之类的指令不太清楚，但大概的意思应该还是两个字符串相等的，那么就让 <code>(const __m128i *)&amp;v15), (__m128i)xmmword_BE0)</code> 和 <code>((char *)&amp;v15 + 9)), (__m128i)xmmword_BD0))</code> 两两相等即可</p>
<p>在字符串中找到这两个，就能得到 <code>3g6L2PWL2PXFmR+7ise7iq==</code>，这个看起来是一个 base64，但解出来是乱码，所以还是得往前看。上面一大段从 <code>while</code> 开始的代码，显然就是 base64 的最后一步，点开字符串，发现这个不是标准的 base64。那么根据这个字符串反向求解 base64 就可以了。</p>
<p>实际操作时，继续阅读了 <code>sub_820</code> 和 <code>sub_710</code> 两个函数。只看 <code>sub_820</code> 的话看不太懂，建议先看 <code>sub_710</code>，发现 <code>sub_710</code> 中，将一个字符串的每个字符根据 ascii 数值直接拆开到了八个 char 上，每个 char 存 <code>&#39;0&#39;</code> 或 <code>&#39;1&#39;</code> （ <code>0x30</code> 和 <code>0x31</code> ）。到了 <code>sub_820</code> 函数，则每六个进行合并，每一位运算看起来很奇怪，但如果用 <code>0x30</code> 和 <code>0x31</code> 带入会发现就是很简单的将 0 和1 重新组合起来。就是做了一个 base64 运算。</p>
<p>于是写个代码反向求解就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">en_key = <span class="string">&#x27;7+RmFXP2LWP2L6g3&#x27;</span>[::<span class="number">-1</span>] + <span class="string">&#x27;==qi7esi&#x27;</span>[::<span class="number">-1</span>]</span><br><span class="line">true_base = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&#x27;+/&#x27;</span></span><br><span class="line">fake_base = string.ascii_lowercase + string.digits + <span class="string">&#x27;+/&#x27;</span> + string.ascii_uppercase</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> en_key:</span><br><span class="line">    <span class="keyword">if</span> c == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">        key += c</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    key += true_base[fake_base.index(c)]</span><br><span class="line"></span><br><span class="line">key = base64.b64decode(key)</span><br><span class="line">print(key)</span><br></pre></td></tr></table></figure>
<p>得到 key: <code>th1s_1s_k3y!!!!!</code></p>
<blockquote>
<p>这里我因为打错了base的字符串，卡了整整一天（</p>
</blockquote>
<p>接下来就可以去求明文密码了</p>
<p>继续阅读 java 代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Encrypt</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Encrypt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">en1</span><span class="params">(<span class="keyword">int</span>[] arg6, String arg7, <span class="keyword">int</span> arg8)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> v0 = <span class="number">0x100</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] v1 = <span class="keyword">new</span> <span class="keyword">byte</span>[v0];</span><br><span class="line">        <span class="keyword">byte</span>[] v7 = arg7.getBytes();</span><br><span class="line">        <span class="keyword">int</span> v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v3;</span><br><span class="line">        <span class="keyword">for</span>(v3 = <span class="number">0</span>; v3 &lt; v0; ++v3) &#123;</span><br><span class="line">            arg6[v3] = <span class="number">0x100</span> - v3;  <span class="comment">// 256-1降序</span></span><br><span class="line">            v1[v3] = v7[v3 % arg8];  <span class="comment">// 用密钥填满v1</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> v7_1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(v2 &lt; v0) &#123;</span><br><span class="line">            v7_1 = (arg6[v2] + v7_1 + v1[v2]) % <span class="number">0x100</span>;</span><br><span class="line">            arg8 = arg6[v2];</span><br><span class="line">            arg6[v2] = arg6[v7_1];</span><br><span class="line">            arg6[v7_1] = arg8;</span><br><span class="line">            ++v2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">en2</span><span class="params">(<span class="keyword">int</span>[] arg7, <span class="keyword">byte</span>[] arg8, <span class="keyword">int</span> arg9)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> v0 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(v0 &lt; arg9) &#123;</span><br><span class="line">            v1 = (v1 + <span class="number">1</span>) % <span class="number">0x100</span>;</span><br><span class="line">            v2 = ((arg7[v1] &amp; <span class="number">0xFF</span>) + v2) % <span class="number">0x100</span>;</span><br><span class="line">            <span class="keyword">int</span> v3 = arg7[v1];</span><br><span class="line">            arg7[v1] = arg7[v2];</span><br><span class="line">            arg7[v2] = v3;</span><br><span class="line">            arg8[v0] = ((<span class="keyword">byte</span>)(arg8[v0] ^ arg7[((arg7[v1] &amp; <span class="number">0xFF</span>) + (arg7[v2] &amp; <span class="number">0xFF</span>)) % <span class="number">0x100</span>]));</span><br><span class="line">            ++v0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">file</span><span class="params">(<span class="keyword">byte</span>[] arg6, String arg7)</span> </span>&#123;  <span class="comment">// passwd, key = &#x27;th1s_1s_k3ya!!!!&#x27;</span></span><br><span class="line">        <span class="keyword">int</span>[] v0 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0x100</span>];</span><br><span class="line">        <span class="keyword">int</span> v1 = <span class="number">17</span>;</span><br><span class="line">        <span class="keyword">int</span>[] v2 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0x8B</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>, <span class="number">0x5D</span>, <span class="number">0x95</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x5F</span>, <span class="number">0x29</span>, <span class="number">0x56</span>, <span class="number">0x12</span>, <span class="number">0xB9</span>, <span class="number">0xEF</span>, <span class="number">0xEC</span>, <span class="number">0x8B</span>, <span class="number">0xD0</span>, <span class="number">0x45</span>&#125;;</span><br><span class="line">        <span class="keyword">this</span>.en1(v0, arg7, arg7.length());</span><br><span class="line">        <span class="keyword">this</span>.en2(v0, arg6, arg6.length);</span><br><span class="line">        <span class="keyword">if</span>(arg6.length != v1) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> v7;</span><br><span class="line">        <span class="keyword">for</span>(v7 = <span class="number">0</span>; v7 &lt; v1; ++v7) &#123;</span><br><span class="line">            <span class="keyword">if</span>((arg6[v7] &amp; <span class="number">0xFF</span>) != v2[v7]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>懂的话就会发现这个就是一个s盒从 <code>0-255</code> 变成 <code>256-1</code> 的 <code>RC4</code> 密码</p>
<p>不懂的话直接把代码复制出来，把 <code>file</code> 函数改写成 <code>main</code> 函数，反向求解一下就行（因为仔细观察就可以发现 <code>en2</code> 只对明文做了个异或运算，且异或的对象和明文本身没有关系），这里当密码学的题来做其实就好了。</p>
<p>这是我复制后改写的 java 代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">en1</span><span class="params">(<span class="keyword">int</span>[] arg6, String arg7, <span class="keyword">int</span> arg8)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> v0 = <span class="number">0x100</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] v1 = <span class="keyword">new</span> <span class="keyword">byte</span>[v0];</span><br><span class="line">        <span class="keyword">byte</span>[] v7 = arg7.getBytes();</span><br><span class="line">        <span class="keyword">int</span> v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v3;</span><br><span class="line">        <span class="keyword">for</span>(v3 = <span class="number">0</span>; v3 &lt; v0; ++v3) &#123;</span><br><span class="line">            arg6[v3] = <span class="number">0x100</span> - v3;  <span class="comment">// 256-1降序</span></span><br><span class="line">            v1[v3] = v7[v3 % arg8];  <span class="comment">// 用密钥填满v1</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> v7_1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(v2 &lt; v0) &#123;</span><br><span class="line">            v7_1 = (arg6[v2] + v7_1 + v1[v2]) % <span class="number">0x100</span>;</span><br><span class="line">            arg8 = arg6[v2];</span><br><span class="line">            arg6[v2] = arg6[v7_1];</span><br><span class="line">            arg6[v7_1] = arg8;</span><br><span class="line">            ++v2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">en2</span><span class="params">(<span class="keyword">int</span>[] arg7, <span class="keyword">int</span>[] arg8, <span class="keyword">int</span> arg9)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> v0 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(v0 &lt; arg9) &#123;</span><br><span class="line">            v1 = (v1 + <span class="number">1</span>) % <span class="number">0x100</span>;</span><br><span class="line">            v2 = ((arg7[v1] &amp; <span class="number">0xFF</span>) + v2) % <span class="number">0x100</span>;</span><br><span class="line">            <span class="keyword">int</span> v3 = arg7[v1];</span><br><span class="line">            arg7[v1] = arg7[v2];</span><br><span class="line">            arg7[v2] = v3;</span><br><span class="line">            arg8[v0] = ((<span class="keyword">byte</span>)(arg8[v0] ^ arg7[((arg7[v1] &amp; <span class="number">0xFF</span>) + (arg7[v2] &amp; <span class="number">0xFF</span>)) % <span class="number">0x100</span>]));</span><br><span class="line">            ++v0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String arg7 = <span class="string">&quot;th1s_1s_k3y!!!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span>[] arg6 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0x8B</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>, <span class="number">0x5D</span>, <span class="number">0x95</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x5F</span>, <span class="number">0x29</span>, <span class="number">0x56</span>, <span class="number">0x12</span>, <span class="number">0xB9</span>, <span class="number">0xEF</span>, <span class="number">0xEC</span>, <span class="number">0x8B</span>, <span class="number">0xD0</span>, <span class="number">0x45</span>&#125;;</span><br><span class="line">        <span class="keyword">int</span>[] v0 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0x100</span>];</span><br><span class="line">        <span class="keyword">int</span> v1 = <span class="number">17</span>;</span><br><span class="line">        <span class="keyword">int</span>[] v2 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;&#125;;</span><br><span class="line">        en1(v0, arg7, arg7.length());</span><br><span class="line">        en2(v0, arg6, arg6.length);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arg6.length; i++) &#123;</span><br><span class="line">            System.out.print((<span class="keyword">char</span>)(arg6[i] &amp; <span class="number">0xff</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然也可以跟在第一段 python 后面继续写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">en_key = <span class="string">&#x27;7+RmFXP2LWP2L6g3&#x27;</span>[::<span class="number">-1</span>] + <span class="string">&#x27;==qi7esi&#x27;</span>[::<span class="number">-1</span>]</span><br><span class="line">true_base = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&#x27;+/&#x27;</span></span><br><span class="line">fake_base = string.ascii_lowercase + string.digits + <span class="string">&#x27;+/&#x27;</span> + string.ascii_uppercase</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> en_key:</span><br><span class="line">    <span class="keyword">if</span> c == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">        key += c</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    key += true_base[fake_base.index(c)]</span><br><span class="line"></span><br><span class="line">key = base64.b64decode(key)</span><br><span class="line">print(key)</span><br><span class="line"><span class="comment"># th1s_1s_k3y!!!!!</span></span><br><span class="line"></span><br><span class="line">ciphertext = [<span class="number">0x8B</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>, <span class="number">0x5D</span>, <span class="number">0x95</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x5F</span>, <span class="number">0x29</span>, <span class="number">0x56</span>, <span class="number">0x12</span>, <span class="number">0xB9</span>, <span class="number">0xEF</span>, <span class="number">0xEC</span>, <span class="number">0x8B</span>, <span class="number">0xD0</span>, <span class="number">0x45</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">en1</span>(<span class="params">key, len_key</span>):</span></span><br><span class="line">    res = []</span><br><span class="line">    v0 = <span class="number">0x100</span></span><br><span class="line">    v1 = [<span class="number">0</span>] * v0</span><br><span class="line">    v7 = [c <span class="keyword">for</span> c <span class="keyword">in</span> key]</span><br><span class="line">    v2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> v3 <span class="keyword">in</span> <span class="built_in">range</span>(v0):</span><br><span class="line">        res.append(<span class="number">0x100</span> - v3)</span><br><span class="line">        v1[v3] = v7[v3 % len_key]</span><br><span class="line">    v7_1 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> v2 &lt; v0:</span><br><span class="line">        v7_1 = (res[v2] + v7_1 + v1[v2]) % <span class="number">0x100</span></span><br><span class="line">        len_key = res[v2]</span><br><span class="line">        res[v2] = res[v7_1]</span><br><span class="line">        res[v7_1] = len_key</span><br><span class="line">        v2 += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">en2</span>(<span class="params">res_key, text, len_text</span>):</span></span><br><span class="line">    v0 = <span class="number">0</span></span><br><span class="line">    v1 = <span class="number">0</span></span><br><span class="line">    v2 = <span class="number">0</span></span><br><span class="line">    <span class="comment"># text = bytes(text)</span></span><br><span class="line">    <span class="keyword">while</span> v0 &lt; len_text:</span><br><span class="line">        v1 = (v1 + <span class="number">1</span>) % <span class="number">0x100</span></span><br><span class="line">        v2 = ((res_key[v1] &amp; <span class="number">0xFF</span>) + v2) % <span class="number">0x100</span></span><br><span class="line">        v3 = res_key[v1]</span><br><span class="line">        res_key[v1] = res_key[v2]</span><br><span class="line">        res_key[v2] = v3</span><br><span class="line">        text[v0] = ((text[v0] ^ res_key[((res_key[v1] &amp; <span class="number">0xFF</span>) + (res_key[v2] &amp; <span class="number">0xFF</span>)) % <span class="number">0x100</span>]))</span><br><span class="line">        v0 += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line">list_key = en1(key[:], <span class="built_in">len</span>(key))</span><br><span class="line">plaintext = en2(list_key[:], ciphertext[:], <span class="built_in">len</span>(ciphertext))</span><br><span class="line"><span class="built_in">print</span> (plaintext)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> plaintext:</span><br><span class="line">    flag += <span class="built_in">chr</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure>
<p>这样就拿到密码了 <code>Y0uG3tTheP4ssw0rd</code></p>
<p>然后将 apk 解压一下（用的 bandizip，可以直接解压），在目录下面可以找到 <code>\assets\flag.zip</code></p>
<p>解压即可拿到 flag</p>
<h1 id="easy-mips-（mips-逆向）"><a href="#easy-mips-（mips-逆向）" class="headerlink" title="easy_mips （mips 逆向）"></a>easy_mips （mips 逆向）</h1><p>这是一道mips的题，用ida无法反汇编，<del>爬了</del></p>
<p>先用ida的字符串搜索找到了关键代码在 <code>tty_write</code> 函数里，并且调用了 <code>encry</code> 函数和 <code>init</code> 函数，但因为没学过mips，也就没法继续分析了</p>
<p>于是第一次尝试使用 Ghidra</p>
<p>用 Ghidra 打开二进制文件</p>
<p>找到关键函数 <code>tty_write</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tty_write</span><span class="params">(<span class="keyword">char</span> *param_1,<span class="keyword">char</span> *param_2)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> __fd;</span><br><span class="line">  <span class="keyword">size_t</span> __n;</span><br><span class="line">  <span class="keyword">int</span> iVar1;</span><br><span class="line">  EVP_PKEY_CTX aEStack56 [<span class="number">20</span>];</span><br><span class="line">  undefined4 local_24;</span><br><span class="line">  undefined4 local_20;</span><br><span class="line">  undefined4 local_1c;</span><br><span class="line">  undefined4 local_18;</span><br><span class="line">  undefined4 local_14;</span><br><span class="line">  <span class="keyword">char</span> local_10;</span><br><span class="line">  <span class="keyword">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  local_c = __stack_chk_guard;</span><br><span class="line">  local_24 = <span class="number">0x666c6167</span>;</span><br><span class="line">  local_20 = <span class="number">0x7b69745f</span>;</span><br><span class="line">  local_1c = <span class="number">0x69735f5f</span>;</span><br><span class="line">  local_18 = <span class="number">0x5f5f6661</span>;</span><br><span class="line">  local_14 = <span class="number">0x6b657d0a</span>;</span><br><span class="line">  local_10 = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  __fd = open(param_1,<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> (__fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;cannot open&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  __n = <span class="built_in">strlen</span>(param_2);</span><br><span class="line">  write(__fd,param_2,__n);</span><br><span class="line">  read(__fd,aEStack56,<span class="number">0x13</span>);</span><br><span class="line">  encry(aEStack56);</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>((<span class="keyword">char</span> *)aEStack56,(<span class="keyword">char</span> *)&amp;local_24);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) &#123;</span><br><span class="line">    write(__fd,<span class="string">&quot;you get the fake flag\n&quot;</span>,<span class="number">0x16</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    iVar1 = <span class="built_in">strcmp</span>((<span class="keyword">char</span> *)aEStack56,<span class="string">&quot;3_isjA0UeQZcNa\\`\\Vf&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;you_don\&#x27;t_get_the_flag&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LAB_00400b48;</span><br><span class="line">    &#125;</span><br><span class="line">    write(__fd,<span class="string">&quot;good_job!\n&quot;</span>,<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  close(__fd);</span><br><span class="line">LAB_00400b48:</span><br><span class="line">  <span class="keyword">if</span> (local_c != __stack_chk_guard) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之前在 ida 中发现 <code>local_24</code> 是一个fake flag，就不管了</p>
<p>发现调用了一个 <code>encry</code> 函数，进入这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encry</span><span class="params">(EVP_PKEY_CTX *param_1)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> cVar1;</span><br><span class="line">  <span class="keyword">int</span> local_10;</span><br><span class="line">  </span><br><span class="line">  init(param_1);</span><br><span class="line">  cVar1 = <span class="string">&#x27;\x05&#x27;</span>;</span><br><span class="line">  local_10 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (local_10 &lt; <span class="number">0x13</span>) &#123;</span><br><span class="line">    param_1[local_10] = (EVP_PKEY_CTX)((<span class="keyword">char</span>)param_1[local_10] - cVar1);</span><br><span class="line">    cVar1 = cVar1 + <span class="string">&#x27;\x01&#x27;</span>;</span><br><span class="line">    local_10 = local_10 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现先调用了 <code>init</code> 函数，然后对每一位做了个减法</p>
<p>查看 <code>init</code> 函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">(EVP_PKEY_CTX *ctx)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> iVar1;</span><br><span class="line">  <span class="keyword">char</span> extraout_var;</span><br><span class="line">  <span class="keyword">char</span> extraout_var_00;</span><br><span class="line">  <span class="keyword">char</span> extraout_var_01;</span><br><span class="line">  <span class="keyword">int</span> local_20;</span><br><span class="line">  </span><br><span class="line">  iVar1 = __stack_chk_guard;</span><br><span class="line">  srand(<span class="number">0x1c5e</span>);</span><br><span class="line">  rand();</span><br><span class="line">  rand();</span><br><span class="line">  rand();</span><br><span class="line">  *ctx = (EVP_PKEY_CTX)((byte)*ctx ^ extraout_var + <span class="number">0x32</span>U);</span><br><span class="line">  ctx[<span class="number">5</span>] = (EVP_PKEY_CTX)((byte)ctx[<span class="number">5</span>] ^ extraout_var_00 - <span class="number">0x39</span>U);</span><br><span class="line">  ctx[<span class="number">6</span>] = (EVP_PKEY_CTX)((byte)ctx[<span class="number">6</span>] ^ extraout_var_01 + <span class="number">0x30</span>U);</span><br><span class="line">  local_20 = <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">while</span> (local_20 &lt; <span class="number">0xd</span>) &#123;</span><br><span class="line">    local_20 = local_20 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != __stack_chk_guard) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __stack_chk_guard;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里自动分析出现了问题，不知道 <code>extraout_var</code> 和 <code>rand</code> 有什么关系</p>
<p>于是只能去找对应的汇编慢慢读</p>
<p>根据 Ghidra 里代码与汇编的映射关系，找到了 <code>extraout_var</code> 的位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00400d00 80  43  00  00    lb         v1,0x0 (v0)</span><br><span class="line">00400d04 8f  c2  00  24    lw         v0,local_1c (s8)</span><br><span class="line">00400d08 30  42  00  ff    andi       v0,v0,0xff</span><br><span class="line">00400d0c 24  42  00  32    addiu      v0,v0,0x32</span><br><span class="line">00400d10 30  42  00  ff    andi       v0,v0,0xff</span><br><span class="line">00400d14 7c  02  14  20    seb        v0,v0</span><br><span class="line">00400d18 00  62  10  26    xor        v0,v1,v0</span><br><span class="line">00400d1c 7c  02  1c  20    seb        v1,v0</span><br><span class="line">00400d20 8f  c2  00  1c    lw         v0,local_24 (s8)</span><br><span class="line">00400d24 a0  43  00  00    sb         v1,0x0 (v0)</span><br></pre></td></tr></table></figure>
<p>找到 <code>addiu</code> 说明 <code>v0</code> 对应的就是 <code>extraout_var</code>，发现是从 <code>local_1c</code> 处取出的</p>
<p>往上找 <code>local_1c</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">00400c80 8f  dc  00  10    lw         gp,local_30 (s8)</span><br><span class="line">00400c84 8f  82  80  44    lw         v0,-0x7fbc (gp)&#x3D;&gt;-&gt;rand                          &#x3D; 004010e0</span><br><span class="line">00400c88 00  40  c8  25    or         t9,v0,zero</span><br><span class="line">00400c8c 03  20  f8  09    jalr       t9&#x3D;&gt;rand                                         int rand(void)</span><br><span class="line">00400c90 00  00  00  00    _nop</span><br><span class="line">00400c94 8f  dc  00  10    lw         gp,local_30 (s8)</span><br><span class="line">00400c98 00  40  18  25    or         v1,v0,zero</span><br><span class="line">00400c9c 83  c2  00  31    lb         v0,local_10 +0x1 (s8)</span><br><span class="line">00400ca0 00  62  10  26    xor        v0,v1,v0</span><br><span class="line">00400ca4 00  02  16  03    sra        v0,v0,0x18</span><br><span class="line">00400ca8 af  c2  00  24    sw         v0,local_1c (s8)</span><br></pre></td></tr></table></figure>
<p>从后往前看，最后是将 v0 存到 local_1c 中，倒数第二步是将 v0 右移 0x18 位（这里问了一下会mips的大佬…），虽然没法完美分析出 rand 的结果存到了哪里，但是可以猜测最后右移了 0x18 位并存到了 <code>local_1c</code> 中。</p>
<p>于是就可以尝试编写代码，破解flag了。</p>
<p>首先计算几个 <code>rand</code> 的结果</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    srand(<span class="number">0x1c5e</span>);</span><br><span class="line">    <span class="keyword">char</span> a[<span class="number">20</span>];</span><br><span class="line">    a[<span class="number">0</span>] = <span class="string">&#x27;8&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, rand());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, rand());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, rand());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./test_rand</span><br><span class="line">446aef60</span><br><span class="line">5de30bb4</span><br><span class="line">27445d71</span><br></pre></td></tr></table></figure>
<p>随后写个反向的算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">encry = <span class="string">b&#x27;3_isjA0UeQZcNa\\`\\Vf&#x27;</span></span><br><span class="line">flag_1 = []</span><br><span class="line">t = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> encry:</span><br><span class="line">    flag_1.append(i + t)</span><br><span class="line">    t += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span> (flag_1)</span><br><span class="line"></span><br><span class="line">rand = [<span class="number">0x44</span> + <span class="number">0x32</span>, <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0x5d</span> - <span class="number">0x39</span>, <span class="number">0x27</span> + <span class="number">0x30</span>] + [<span class="number">0</span>] * <span class="number">15</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag_1)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(flag_1[i] ^ (rand[i] &amp; <span class="number">0xff</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure>
<p>得到最终的flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">56</span>, <span class="number">101</span>, <span class="number">112</span>, <span class="number">123</span>, <span class="number">115</span>, <span class="number">75</span>, <span class="number">59</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">95</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">115</span>, <span class="number">111</span>, <span class="number">116</span>, <span class="number">113</span>, <span class="number">108</span>, <span class="number">125</span>]</span><br><span class="line">Nep&#123;solar_is_sotql&#125;</span><br></pre></td></tr></table></figure>
<h1 id="worrrrms-（go语言逆向）"><a href="#worrrrms-（go语言逆向）" class="headerlink" title="worrrrms （go语言逆向）"></a>worrrrms （go语言逆向）</h1><p>只知道用了SM4算法加密，不会go语言，具体的看不懂，爬了。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这个比赛的前五道题其实就是各个方向的入门题目，有相应的工具并且能够看懂伪代码就可以做了，只需要进行静态分析。做go语言的时候发现go的函数调用太奇怪了，而且有各种指针，不愧是最安全的语言。</p>
<p>至于后面的几道题，由于解的人太少，也就没有去看，看完wp再补。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/03/17/HGAME2021-week1-crypto-%E5%AF%B9%E7%A7%B0%E4%B9%8B%E7%BE%8E/" rel="prev" title="HGAME2021 week1 crypto 对称之美">
      <i class="fa fa-chevron-left"></i> HGAME2021 week1 crypto 对称之美
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/03/25/VNCTF2021-re-FilpGame/" rel="next" title="VNCTF2021 re FilpGame">
      VNCTF2021 re FilpGame <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#hardsharp-NET-%E9%80%86%E5%90%91"><span class="nav-number">1.</span> <span class="nav-text">hardsharp (.NET 逆向)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6-%EF%BC%88c-c-%E9%80%86%E5%90%91%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">二十六进制 （c &#x2F; c++ 逆向）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#password-%EF%BC%88%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">password （安卓逆向）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#easy-mips-%EF%BC%88mips-%E9%80%86%E5%90%91%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">easy_mips （mips 逆向）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#worrrrms-%EF%BC%88go%E8%AF%AD%E8%A8%80%E9%80%86%E5%90%91%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">worrrrms （go语言逆向）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="s0uthwood"
      src="/images/avatar3.jpg">
  <p class="site-author-name" itemprop="name">s0uthwood</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">37</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://psyduck0409.github.io/" title="https:&#x2F;&#x2F;psyduck0409.github.io&#x2F;" rel="noopener" target="_blank">DaiDai</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://justloseit.top/" title="http:&#x2F;&#x2F;justloseit.top&#x2F;" rel="noopener" target="_blank">Joker</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kfxp12138.github.io/" title="https:&#x2F;&#x2F;kfxp12138.github.io&#x2F;" rel="noopener" target="_blank">triplewings</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://fyhssgss.github.io/" title="https:&#x2F;&#x2F;fyhssgss.github.io&#x2F;" rel="noopener" target="_blank">FYHSSGSS</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://xz1548.github.io/" title="https:&#x2F;&#x2F;xz1548.github.io&#x2F;" rel="noopener" target="_blank">Zhr</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://newbiereer.github.io/" title="https:&#x2F;&#x2F;newbiereer.github.io&#x2F;" rel="noopener" target="_blank">NewBieReer</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">s0uthwood</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">350k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">5:18</span>
</div>
  <div class="powered-by">Powered By - <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest-nomobile.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
